<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/css-others/w.css">
    <title>worms — pwn</title>
    <link rel="shortcut icon" href="/img/favicon.png" type="image/x-icon">
    <script src="/js/glitch.js"></script>
    <script src="/js/newtab.js"></script>
</head>

<body>
    <div class="main_container">

        <main class="content">
            <pre>
                                                                 
      ┌──────────────────────────────────────────────────────┐   
      │ [ERR] Buffer overflow at 0x7ffdeadc0de               │   
      │ [MEM] Stack corruption detected!                     │   
      │ [1337] .....................................pwn3d!   │   
      └──────────────────────────────────────────────────────┘   
                                                                 
            </pre>
            <div>
                <div id="authWidget" style="margin-bottom:12px"></div>
                <ul id="wormsList">
                    <li>carregando worms...</li>
                </ul>
            </div>

            <a href="/" class="back-link">← Voltar para a página principal</a>
        </main>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {

            // Fetch worms and render
            async function fetchWorms() {
                try {
                    const r = await fetch('/api/worms')
                    const j = await r.json()
                    const ul = document.getElementById('wormsList')
                    ul.innerHTML = ''
                    if (!r.ok) {
                        ul.innerHTML = '<li class="error">Erro ao carregar worms</li>'
                        return
                    }
                    const worms = j.worms || []
                    if (!worms.length) ul.innerHTML = '<li>(nenhum worm)</li>'
                    worms.forEach(w => {
                        const li = document.createElement('li')
                        li.textContent = w.userName + ' — ' + new Date(w.createdAt).toLocaleDateString()
                        ul.appendChild(li)
                    })
                } catch (e) {
                    const ul = document.getElementById('wormsList')
                    ul.innerHTML = '<li class="error">Erro: ' + e.message + '</li>'
                }
            }

            fetchWorms()
        });
    </script>
</body>

</html>